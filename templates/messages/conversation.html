{% extends 'base.html' %}

{% block title %}–ß–∞—Ç —Å {{ other_user.username }}{% endblock %}

{% block content %}
<div class="card">
    <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 2rem; padding-bottom: 1rem; border-bottom: 2px solid #e1e8ed;">
        {% if other_user.profile_picture %}
            <img src="{{ other_user.profile_picture.url }}" 
                 class="profile-picture-medium" 
                 alt="{{ other_user.username }}">
        {% else %}
            <div class="profile-picture-medium" 
                 style="background: #3498db; color: white; display: flex; align-items: center; justify-content: center; font-weight: bold;">
                {{ other_user.username|first|upper }}
            </div>
        {% endif %}
        <div>
            <h2 style="margin: 0;">üí¨ {{ other_user.username }}</h2>
            <p style="margin: 0; color: #666;">–û–±—â–µ–Ω–∏–µ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏</p>
        </div>
    </div>

    <div class="messages-container" style="max-height: 500px; overflow-y: auto; margin-bottom: 2rem;">
        {% for message in messages %}
            <div style="margin-bottom: 1rem; display: flex; {% if message.sender == user %}justify-content: flex-end{% else %}justify-content: flex-start{% endif %};">
                <div style="max-width: 70%;">
                    <div style="background: {% if message.sender == user %}#3498db{% else %}#e1e8ed{% endif %}; 
                                color: {% if message.sender == user %}white{% else %}black{% endif %}; 
                                padding: 0.75rem 1rem; 
                                border-radius: 18px; 
                                word-wrap: break-word;">
                        {{ message.content }}
                    </div>
                    <small style="color: #999; font-size: 0.8rem; display: block; margin-top: 0.25rem;">
                        {{ message.timestamp|time }}
                        {% if message.sender == user and message.is_read %}
                            ‚úì‚úì
                        {% elif message.sender == user %}
                            ‚úì
                        {% endif %}
                    </small>
                </div>
            </div>
        {% empty %}
            <p style="text-align: center; color: #666; padding: 2rem;">
                –ù–∞—á–Ω–∏—Ç–µ –æ–±—â–µ–Ω–∏–µ —Å {{ other_user.username }}!
            </p>
        {% endfor %}
    </div>

    <form method="post" style="display: flex; gap: 1rem;">
        {% csrf_token %}
        <div style="flex: 1;">
            {{ form.content }}
        </div>
        <button type="submit">üì§</button>
    </form>
</div>
{% endblock %}